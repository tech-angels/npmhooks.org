<header class="header">
  <h1>Webhook notifications whenever a npm package gets updated.</h1>
</header>

<h2>API Authorization</h2>
<% if current_user %>
  <p>Your API key: <strong><%= current_user.api_key %></strong></p>
<% else %>
  <p>To obtain an API key, simply click the <strong>Log in with GitHub</strong> button above.</p>
<% end %>
<p>API calls require an Authorization header. Here is an example:</p>
<pre>
$ curl -H 'Authorization:<%= current_user.api_key %>' \
       <%= api_v1_web_hooks_url(:only_path => false) %>
</pre>

<h2>WebHook Methods</h2>
<h3>GET - <code><%= api_v1_web_hooks_path %></code></h3>
<p>List the webhooks registered under your account.</p>
<pre>
$ curl -H 'Authorization:<%= current_user.api_key %>' \
       <%= api_v1_web_hooks_url(:only_path => false) %>

[
  {
    "failure_count": 12,
    "url": "http://example.com"
  }
]
</pre>

<h3>POST - <code><%= api_v1_web_hooks_path %></code></h3>
<p>Create a webhook. Requires one parameter: <code>url</code>.</p>
<pre>
$ curl -H 'Authorization:<%= current_user.api_key %>' \
       -F 'url=http://example.com' \
       <%= api_v1_web_hooks_url(:only_path => false) %>

Successfully created webhook to http://example.com
</pre>

<h3>DELETE - <code><%= remove_api_v1_web_hooks_path %></code></h3>
<p>Remove a webhook. Requires one parameter: <code>url</code>.</p>
<pre>
$ curl -H 'Authorization:<%= current_user.api_key %>' \
       -F 'url=http://example.com' \
       -X DELETE \
       <%= remove_api_v1_web_hooks_url(:only_path => false) %>

Successfully removed webhook to http://example.com
</pre>

<h3>POST - <code><%= fire_api_v1_web_hooks_path %></code></h3>
<p>Test fire a webhook. This can be used to test out an endpoint at any time, for example when youâ€™re developing your application. Requires one parameter: <code>url</code>.</p>
<p>An <code>Authorization</code> header is included with every fired webhook so you can be sure the request came from NpmHooks.org. The value of the header is the SHA2-hashed concatenation of the package name, the package version and your API key.</p>
<pre>
$ curl -H 'Authorization:<%= current_user.api_key %>' \
       -F 'url=http://example.com' \
       <%= fire_api_v1_web_hooks_url(:only_path => false) %>

Successfully deployed webhook to http://example.com
</pre>

<p>Sample webhook body:</p>
<pre>
{
    "authors": "Guillermo Rauch",
    "dependencies": {
        "development": [{
            "name": "benchmark",
            "requirements": "0.2.2"
        }, {
            "name": "colors",
            "requirements": "0.5.1"
        }, {
            "name": "expresso",
            "requirements": "0.9.2"
        }, {
            "name": "microtime",
            "requirements": "0.1.3-1"
        }, {
            "name": "should",
            "requirements": "*"
        }],
        "runtime": [{
            "name": "policyfile",
            "requirements": "0.0.4"
        }, {
            "name": "redis",
            "requirements": "0.7.2"
        }, {
            "name": "socket.io-client",
            "requirements": "0.9.9"
        }]
    },
    "info": "Real-time apps made cross-browser & easy with a WebSocket-like API",
    "name": "socket.io",
    "source_code_uri": "https://github.com/LearnBoost/socket.io",
    "version": "0.9.9"
}
</pre>
